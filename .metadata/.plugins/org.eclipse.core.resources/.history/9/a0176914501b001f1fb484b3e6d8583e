package manager;

import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.TypedQuery;
import beans.Personne;

@Stateless
public class LoginManager {

    @PersistenceContext
    private EntityManager em;

    public Personne checkLogin(String mail, String mdp) {
        try {
            TypedQuery<Personne> query = em.createQuery("SELECT p FROM Personne p WHERE p.mail = :mail AND p.mdp = :mdp", Personne.class);
            query.setParameter("mail", mail);
            query.setParameter("mdp", mdp);
            return query.getSingleResult();
        } catch (Exception e) {
            return null;
        }
    }

    public void createPeople(Personne personne) {
        em.persist(personne);
    }

    public String createLdap(String prenom, String nom) {
        // Méthode fictive pour générer un LDAP, à implémenter selon les besoins réels
        return (prenom.charAt(0) + nom).toLowerCase();
    }
}
